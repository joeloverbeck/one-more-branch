#!/usr/bin/env node
'use strict';

const fs = require('fs');
const path = require('path');

const SRC_DIR = path.resolve(__dirname, '..', 'public', 'js', 'src');
const OUT_FILE = path.resolve(__dirname, '..', 'public', 'js', 'app.js');

const files = fs.readdirSync(SRC_DIR)
  .filter(f => f.endsWith('.js'))
  .sort();

if (files.length === 0) {
  console.error('No .js files found in', SRC_DIR);
  process.exit(1);
}

const header = '/**\n * One More Branch - Client-side JavaScript\n * Generated by scripts/concat-client-js.js â€” do not edit directly.\n */\n';
const fragments = files.map(f => fs.readFileSync(path.join(SRC_DIR, f), 'utf8'));
const output = header + '\n(function() {\n  \'use strict\';\n\n' + fragments.join('\n') + '})();\n';

fs.writeFileSync(OUT_FILE, output, 'utf8');
console.log('Concatenated %d files -> %s (%d bytes)', files.length, OUT_FILE, output.length);
